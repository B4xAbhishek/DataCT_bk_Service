<!DOCTYPE html>
<html>
  <head>
    <title>Vue Ejs Test</title>
    <link href="/ejsAssets/css.css" rel="stylesheet" />
    <link href="/ejsAssets/css/materialdesignicons.min.css" rel="stylesheet" />
    <link href="/ejsAssets/vuetify.min.css" rel="stylesheet" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui"
    />
  </head>
  <body>
    <div id="app">
      <v-app>
        <v-main>
          <v-container>
            <div class="mb-3">
              <v-card color="basil" flat>

                <!-- headerr -->
                <v-card style="background-color: white !important" class="pa-2">
                        <v-container>
                          <v-row class="mb-5" justify="center">
                              <img src="/ejsAssets/images/Lohia_Logo.png"
                                alt="LOGO"
                                width="300px">
                          </v-row>
                          
                        </v-container>
                        <v-container>
                        <v-card elevation="3" style="background-color: white !important" class="pa-5">
                          <v-row>
                          <v-row class="mt-5 mb-5" justify="center">
                              <h1 class="text-uppercase" style="color:#002160;">
                
                                MOULD REPORT</h1>
                          </v-row>
                            
                          </v-row>
                          </v-card>
                          </v-container>
                        <div class="pa-2 mt-4">
                          <v-row  class="pa-1 d-flex justify-space-between">
                            <v-col
                              class="title d-flex justify-left">
                            <h4 class="text-uppercase" style="color:#002160;">Start Date: {{new Date(infoData['date']['start']).toDateString()}} </h4>
                            </v-col>
                            <v-col
                              class="title justify-right text-right">
                            <h4 class="text-uppercase" style="color:#002160;">End Date: {{new Date(infoData['date']['end']).toDateString()}} </h4>
                            </v-col>
                  
                          
                          </v-row>
                          </div>
                        </v-card>
                        <v-divider></v-divider>
                        <div class="printmedia">
                        </div>
                    <v-row v-for="item in infoData['parameters']" class="pt-1 d-flex justify-space-between">
                      <v-col
                        class=" subtitle mt-2 d-flex justify-start"
                        cols="12"
                        sm="12"
                        md="12"
                        lg="12"
                      > <h6 class="subtitle-head">{{item["name"]}}:</h6> <span> {{item["value"].toString()}}
                       </span></v-col
                      >
            
                    </v-row>
                  </div>
                
              <!-- headerr -->
              <div class="printmedia">
              </div>
              <!-- <v-card> -->
                <div id="counter-wrapper">
                  <v-row align="center" class="pa-3">
                  <v-col v-if="counterText && counterText['count']" cols="6" sm="12" lg="3">
                    <v-card light elevation="6">
                      <v-card-text>
                        <div class="d-flex flex-no-wrap justify-space-between">
                          <div>
                            <span class=""><h4 class="font-weight-bold">Total Mould Changes:</h4></span>
                            <p class="subtitle-2 mb-0 pa-0 text--primary">
                              {{ counterText['count'] }}
                            </p>
                          </div>
                        </div>
                      </v-card-text>
                    </v-card>
                  </v-col>
                  <v-col v-if="counterText && counterText['avgDuration']" cols="6" sm="12" lg="3">
                    <v-card light elevation="6">
                      <v-card-text>
                        <div class="d-flex flex-no-wrap justify-space-between">
                          <div>
                            <span class=""><h4>Avg Mould Change Time:</h4></span>
                            <p class="subtitle-2 mb-0 pa-0 text--primary">
                              {{ counterText['avgDuration'] }} min
                            </p>
                          </div>
                        </div>
                      </v-card-text>
                    </v-card>
                  </v-col>
                  </v-row>
              </div>
              <!-- counterwrapper -->
              <div id="counter-wrapper">
                <v-row align="center" class="pa-3"  v-if="counterData" >
                  <v-col
                  cols="12"
                  sm="6"
                  md="4"
                  lg="3"
                  v-for="(item, index) in counterData['machineWiseData']"
                  :key="index"
                >

                <v-card light elevation="6">
                  <v-card-text>

                    <!-- {{counterData}} -->
                    <div>
                      <span><h4>MachineName</h4></span>
                      <p class="subtitle-2 mb-0 pa-0 text--primary">
                        {{ item.display.MACHINE_DISPLAY }}
                      </p>
                      <v-divider class="py-1"></v-divider>
      
                      <div class="d-flex justify-space-between flex-wrap">
                        <div>
                          <span><h4>MouldChanges</h4></span>
                          <v-card-title class="subtitle-2 mb-0 pa-0 text--primary">
                            {{ item.count }}
                          </v-card-title>
                        </div>
      
                        <div>
                          <span><h4>Average</h4></span>
                          <v-card-title class="subtitle-2 mb-0 pa-0 text--primary">
                            {{ item.average }} (mins)
                          </v-card-title>
                        </div> 
                      </div>
                     
                    </div>
                  </v-card-text>



                </v-card>
                  </v-col>
                   </v-row>
              </div>
              <!-- endofcounterwrapper -->
                

                <!-- data flow -->
                <div>
                  <div class="flow-wrapper" v-if="flowData && flowData.length">
                    <v-card
                      class="flow-wrapper-inside mb-3"
                      color="white"
                      v-for="(item, index1) in flowData"
                      :key="index1"
                    >
                      <!-- <div class="name-wrapper">
                        <p>Machine: {{ item._id }}</p>
                      </div> -->

                      <!--    <v-card-title
                          class="text-h5 text-ellipsis pb-0"
                          v-text="item._id"
                        ></v-card-title> -->
                      <v-card-text>
                        <div class="d-flex flex-no-wrap justify-space-between">
                          <div>
                            <span class=""><small>Machine Name:</small></span>
                            <p class="subtitle-2 mb-0 pa-0 text--primary">
                              {{ item._id }}
                            </p>
                          </div>
                          <div></div>
                        </div>
                        <v-row class="mt-3 mb-3 ml-0 mr-0 pa-3">
                          <v-col
                            cols="3"
                            lg="3"
                            class="card-wrapper mb-2"
                            v-for="(mould, index2) in item.data"
                            :key="index2"
                          >
                            <v-row class="card-wrap mb-3">
                              <v-col cols="10" class="card-wrapper-inner">
                                <p>
                                  {{
                                    (mould.MATERIAL_DESCRIPTION &&
                                      mould.MATERIAL_DESCRIPTION[0] &&
                                      mould.MATERIAL_DESCRIPTION[0][
                                        "MATERIAL_DESCRIPTION"
                                      ]) ||
                                      mould.MATERIAL
                                  }}
                                </p>
                              </v-col>
                              <v-col
                                cols="2"
                                class="arrow-wrapper"
                                v-if="index2 < item.data.length - 1"
                              >
                                <v-icon aria-hidden="false">
                                  mdi-arrow-right-bold
                                </v-icon>
                              </v-col>
                            </v-row>
                            <div class="space-liner">
                              <div>
                                <small
                                  ><label><b>From:</b></label
                                  >{{ mould.FROM_TIME }}</small
                                >
                              </div>
                              <div>
                                <small
                                  ><label><b>To:</b></label
                                  >{{ mould.TO_TIME }}</small
                                >
                              </div>
                            </div>
                          </v-col>
                        </v-row>
                      </v-card-text>
                      <div class="printmedia">
                      </div>
                    </v-card>
                  </div>
                </div>
                <!-- data flow -->
                <div class="printmedia">
                </div>
                <!-- table data -->
                <div class="my-5 ma-2" v-if="pdfTable && tableColumn && tableRow">
                  <v-data-table
                    :headers="tableColumn"
                    :items="tableRow"
                    :server-items-length="tableRow.length"
                    :items-per-page="tableRow.length"
                    hide-default-footer
                    class="elevation-5"
                  >
                    <template v-slot:top>
                      <v-toolbar flat>
                        <v-toolbar-title>DETAILED REPORT</v-toolbar-title>
                      </v-toolbar>
                    </template>
                  </v-data-table>
                </div>
                <!-- table data -->
              <!-- </v-card> -->
              </v-card>
            </div>
          </v-container>
        </v-main>
      </v-app>
    </div>
    <script src="/ejsAssets/plotly-2.8.3.min.js"></script>
    <script src="/ejsAssets/vue.js"></script>
    <script src="/ejsAssets/vuetify.js"></script>
    <!-- <script src="/ejsAssets/colors.js"></script> -->
    <script>
      new Vue({
        el: "#app",
        vuetify: new Vuetify(),
        data: {

          infoData: JSON.parse('<%- infoData %>'),
          counterText: JSON.parse('<%- counterText %>'),
          counterData:JSON.parse('<%- counterData %>'),
          //flow data
          flowData: JSON.parse('<%- flowData %>'),

          //pdfTable
          // pdfTable: JSON.parse('<%- pdfTable %>'),
          // tableColumn: JSON.parse('<%- pdfTable %>').column,
          // tableRow: JSON.parse('<%- pdfTable %>').row,

        }
      });
    </script>
  </body>
</html>
<style>
  @media print {
    .printmedia {
      page-break-after: always;
      margin-top: 30px;
    }
  }
</style>
<style scoped>
  .text-ellipsis{
   white-space: nowrap ;
   word-break: normal;
   overflow: hidden ;
   text-overflow: ellipsis;
 }
</style>
<style scoped>
  p {
    margin-bottom: 0;
  }
  .flow-wrapper {
    width: 100%;
    padding: 10px;
  
    margin: 20px auto;
  }
  .flow-wrapper-inside {
    width: auto;
    margin: auto;
  }
  .name-wrapper {
    width: 50%;
    padding: 10px 10px;
    background: #efefef;
  }
  .card-wrapper {
    width: 50%;
  }
  .card-wrapper-inner {
    border-radius: 6px;
    padding: 10px 10px;
    color: #fff;
    background: linear-gradient(310deg, #7928ca, #be32c7);
  }
  .arrow-wrapper {
    margin: auto;
  }
  .card-wrap {
    display: flex;
    flex-flow: row;
  }
  </style>
  <style scoped>
    .head {
      width: 100%;
      color: #00215f;
      font-family: sans-serif;
    }
    .title {
      color: #00215f;
      font-size: large;
      font-family:  sans-serif;
    }
    .subtitle {
      color: #00215f;
      font-size: medium;
      font-family: sans-serif;
    }
    .subtitle-head {
      padding-right: 8px;
      color: #00215f;
      font-size: medium;
      font-family: sans-serif;
    }
  </style>
